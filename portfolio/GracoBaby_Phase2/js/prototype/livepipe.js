/**
 * @author Ryan Johnson <http://saucytiger.com/>
 * @copyright 2008 PersonalGrid Corporation <http://personalgrid.com/>
 * @package LivePipe UI
 * @license MIT
 * @url http://livepipe.net/core
 * @require prototype.js
 */
"undefined"==typeof Control&&(Control={});var $proc=function(e){return"function"==typeof e?e:function(){return e}},$value=function(e){return"function"==typeof e?e():e};Object.Event={extend:function(e){e._objectEventSetup=function(e){this._observers=this._observers||{},this._observers[e]=this._observers[e]||[]},e.observe=function(e,t){if("string"==typeof e&&"undefined"!=typeof t)this._objectEventSetup(e),this._observers[e].include(t)||this._observers[e].push(t);else for(var n in e)this.observe(n,e[n])},e.stopObserving=function(e,t){this._objectEventSetup(e),e&&t?this._observers[e]=this._observers[e].without(t):e?this._observers[e]=[]:this._observers={}},e.observeOnce=function(e,t){var n=function(){t.apply(this,arguments),this.stopObserving(e,n)}.bind(this);this._objectEventSetup(e),this._observers[e].push(n)},e.notify=function(e){this._objectEventSetup(e);var t=[],n=$A(arguments).slice(1);try{for(var r=0;r<this._observers[e].length;++r)t.push(this._observers[e][r].apply(this._observers[e][r],n)||null)}catch(o){if(o==$break)return!1;throw o}return t},e.prototype&&(e.prototype._objectEventSetup=e._objectEventSetup,e.prototype.observe=e.observe,e.prototype.stopObserving=e.stopObserving,e.prototype.observeOnce=e.observeOnce,e.prototype.notify=function(t){if(e.notify){var n=$A(arguments).slice(1);n.unshift(this),n.unshift(t),e.notify.apply(e,n)}this._objectEventSetup(t);var n=$A(arguments).slice(1),r=[];try{this.options&&this.options[t]&&"function"==typeof this.options[t]&&r.push(this.options[t].apply(this,n)||null);for(var o=0;o<this._observers[t].length;++o)r.push(this._observers[t][o].apply(this._observers[t][o],n)||null)}catch(s){if(s==$break)return!1;throw s}return r})}},Element.addMethods({observeOnce:function(e,t,n){var r=function(){n.apply(this,arguments),Element.stopObserving(e,t,r)};Element.observe(e,t,r)}}),Object.extend(Event,function(){function e(e){return e._prototypeEventID?e._prototypeEventID[0]:(arguments.callee.id=arguments.callee.id||1,e._prototypeEventID=[++arguments.callee.id])}function t(e){return e&&e.include(":")?"dataavailable":(Prototype.Browser.IE||(e={mouseenter:"mouseover",mouseleave:"mouseout"}[e]||e),e)}function n(e){return v[e]=v[e]||{}}function r(e,t){var r=n(e);return r[t]=r[t]||[]}function o(t,n,o){var s=e(t),i=r(s,n);if(i.pluck("handler").include(o))return!1;var u=function(e){return!Event||!Event.extend||e.eventName&&e.eventName!=n?!1:(Event.extend(e),o.call(t,e),void 0)};return!Prototype.Browser.IE&&["mouseenter","mouseleave"].include(n)&&(u=u.wrap(function(e,t){var n=t.relatedTarget,r=t.currentTarget;return n&&n.nodeType==Node.TEXT_NODE&&(n=n.parentNode),n&&n!=r&&!n.descendantOf(r)?e(t):void 0})),u.handler=o,i.push(u),u}function s(e,t,n){var o=r(e,t);return o.find(function(e){return e.handler==n})}function i(e,t,r){var o=n(e);return o[t]?(o[t]=o[t].without(s(e,t,r)),void 0):!1}function u(){for(var e in v)for(var t in v[e])v[e][t]=null}var v=Event.cache;return window.attachEvent&&window.attachEvent("onunload",u),{observe:function(e,n,r){e=$(e);var s=t(n),i=o(e,n,r);return i?(e.addEventListener?e.addEventListener(s,i,!1):e.attachEvent("on"+s,i),e):e},stopObserving:function(o,u,v){o=$(o);var a=e(o),c=t(u);if(!v&&u)return r(a,u).each(function(e){o.stopObserving(u,e.handler)}),o;if(!u)return Object.keys(n(a)).each(function(e){o.stopObserving(e)}),o;var h=s(a,u,v);return h?(o.removeEventListener?o.removeEventListener(c,h,!1):o.detachEvent("on"+c,h),i(a,u,v),o):o},fire:function(e,t,n){e=$(e),e==document&&document.createEvent&&!e.dispatchEvent&&(e=document.documentElement);var r;return document.createEvent?(r=document.createEvent("HTMLEvents"),r.initEvent("dataavailable",!0,!0)):(r=document.createEventObject(),r.eventType="ondataavailable"),r.eventName=t,r.memo=n||{},document.createEvent?e.dispatchEvent(r):e.fireEvent(r.eventType,r),Event.extend(r)}}}()),Object.extend(Event,Event.Methods),Element.addMethods({fire:Event.fire,observe:Event.observe,stopObserving:Event.stopObserving}),Object.extend(document,{fire:Element.Methods.fire.methodize(),observe:Element.Methods.observe.methodize(),stopObserving:Element.Methods.stopObserving.methodize()}),function(){function e(e){var t;if(e.wheelDelta?t=e.wheelDelta/120:e.detail&&(t=-e.detail/3),t){var n=e.element().fire("mouse:wheel",{delta:t});return n.stopped?(e.stop(),!1):void 0}}document.observe("mousewheel",e),document.observe("DOMMouseScroll",e)}();var IframeShim=Class.create({initialize:function(){this.element=new Element("iframe",{style:"position:absolute;filter:progid:DXImageTransform.Microsoft.Alpha(opacity=0);display:none",src:"javascript:void(0);",frameborder:0}),$(document.body).insert(this.element)},hide:function(){return this.element.hide(),this},show:function(){return this.element.show(),this},positionUnder:function(e){var e=$(e),t=e.cumulativeOffset(),n=e.getDimensions();return this.element.setStyle({left:t[0]+"px",top:t[1]+"px",width:n.width+"px",height:n.height+"px",zIndex:e.getStyle("zIndex")-1}).show(),this},setBounds:function(e){for(prop in e)e[prop]+="px";return this.element.setStyle(e),this},destroy:function(){return this.element&&this.element.remove(),this}});