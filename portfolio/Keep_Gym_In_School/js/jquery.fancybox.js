/*
 * FancyBox - simple jQuery plugin for fancy image zooming
 * Examples and documentation at: http://fancy.klade.lv/
 * Version: 1.0.0 (29/04/2008)
 * Copyright (c) 2008 Janis Skarnelis
 * Licensed under the MIT License: http://www.opensource.org/licenses/mit-license.php
 * Requires: jQuery v1.2.1 or later
*/
!function(e){var n,t={},i=new Image,a=["png","jpg","jpeg","gif"],o=1;e.fn.fancybox=function(n){return t.settings=e.extend({},e.fn.fancybox.defaults,n),e.fn.fancybox.init(),this.each(function(){var n=e(this),i=e.metadata?e.extend({},t.settings,n.metadata()):t.settings;n.unbind("click").click(function(){return e.fn.fancybox.start(this,i),!1})})},e.fn.fancybox.start=function(n,i){if(t.animating)return!1;if(i.overlayShow&&(e("#fancy_wrap").prepend('<div id="fancy_overlay"></div>'),e("#fancy_overlay").css({width:e(window).width(),height:e(document).height(),opacity:i.overlayOpacity}),e.browser.msie&&(e("#fancy_wrap").prepend('<iframe id="fancy_bigIframe" scrolling="no" frameborder="0"></iframe>'),e("#fancy_bigIframe").css({width:e(window).width(),height:e(document).height(),opacity:0})),e("#fancy_overlay").click(e.fn.fancybox.close)),t.itemArray=[],t.itemNum=0,jQuery.isFunction(i.itemLoadCallback)){i.itemLoadCallback.apply(this,[t]);for(var a=e(n).children("img:first").length?e(n).children("img:first"):e(n),o={width:a.width(),height:a.height(),pos:e.fn.fancybox.getPosition(a)},f=0;f<t.itemArray.length;f++)t.itemArray[f].o=e.extend({},i,t.itemArray[f].o),(i.zoomSpeedIn>0||i.zoomSpeedOut>0)&&(t.itemArray[f].orig=o)}else if(n.rel&&""!=n.rel)for(var c=e("a[@rel="+n.rel+"]").get(),f=0;f<c.length;f++){var o=e.metadata?e.extend({},i,e(c[f]).metadata()):i,r={url:c[f].href,title:c[f].title,o:o};if(i.zoomSpeedIn>0||i.zoomSpeedOut>0){var a=e(c[f]).children("img:first").length?e(c[f]).children("img:first"):e(n);r.orig={width:a.width(),height:a.height(),pos:e.fn.fancybox.getPosition(a)}}c[f].href==n.href&&(t.itemNum=f),t.itemArray.push(r)}else{var r={url:n.href,title:n.title,o:i};if(i.zoomSpeedIn>0||i.zoomSpeedOut>0){var a=e(n).children("img:first").length?e(n).children("img:first"):e(n);r.orig={width:a.width(),height:a.height(),pos:e.fn.fancybox.getPosition(a)}}t.itemArray.push(r)}e.fn.fancybox.changeItem(t.itemNum)},e.fn.fancybox.changeItem=function(n){e.fn.fancybox.showLoading(),t.itemNum=n,e("#fancy_nav").empty(),e("#fancy_outer").stop(),e("#fancy_title").hide(),e(document).unbind("keydown"),imgRegExp=a.join("|"),imgRegExp=new RegExp("."+imgRegExp+"$","i");var o=t.itemArray[n].url;if(o.match(/#/)){var f=window.location.href.split("#")[0];f=o.replace(f,""),e.fn.fancybox.showItem('<div id="fancy_div">'+e(f).html()+"</div>"),e("#fancy_loading").hide()}else o.match(imgRegExp)?e(i).unbind("load").bind("load",function(){e("#fancy_loading").hide(),t.itemArray[n].o.frameWidth=i.width,t.itemArray[n].o.frameHeight=i.height,e.fn.fancybox.showItem('<img id="fancy_img" src="'+i.src+'" />')}).attr("src",o+"?rand="+Math.floor(999999999*Math.random())):e.fn.fancybox.showItem('<iframe id="fancy_frame" onload="$.fn.fancybox.showIframe()" name="fancy_iframe'+Math.round(1e3*Math.random())+'" frameborder="0" hspace="0" src="'+o+'"></iframe>')},e.fn.fancybox.showIframe=function(){e("#fancy_loading").hide(),e("#fancy_frame").show()},e.fn.fancybox.showItem=function(n){e.fn.fancybox.preloadNeighborImages();var i=e.fn.fancybox.getViewport(),a=e.fn.fancybox.getMaxSize(640,600,t.itemArray[t.itemNum].o.frameWidth,t.itemArray[t.itemNum].o.frameHeight),o=i[2]+Math.round((i[0]-a[0])/2)-20,f=i[3]+Math.round((i[1]-a[1])/2)-40,c={left:o,top:f,width:a[0]+"px",height:a[1]+"px"};t.active?e("#fancy_content").fadeOut("normal",function(){e("#fancy_content").empty(),e("#fancy_outer").animate(c,"normal",function(){e("#fancy_content").append(e(n)).fadeIn("normal"),e.fn.fancybox.updateDetails()})}):(t.active=!0,e("#fancy_content").empty(),e("#fancy_content").is(":animated")&&console.info("animated!"),t.itemArray[t.itemNum].o.zoomSpeedIn>0?(t.animating=!0,c.opacity="show",e("#fancy_outer").css({top:t.itemArray[t.itemNum].orig.pos.top-18,left:t.itemArray[t.itemNum].orig.pos.left-18,height:t.itemArray[t.itemNum].orig.height,width:t.itemArray[t.itemNum].orig.width}),e("#fancy_content").append(e(n)).show(),e("#fancy_outer").animate(c,t.itemArray[t.itemNum].o.zoomSpeedIn,function(){t.animating=!1,e.fn.fancybox.updateDetails()})):(e("#fancy_content").append(e(n)).show(),e("#fancy_outer").css(c).show(),e.fn.fancybox.updateDetails()))},e.fn.fancybox.updateDetails=function(){e("#fancy_bg,#fancy_close").show(),void 0!==t.itemArray[t.itemNum].title&&""!==t.itemArray[t.itemNum].title&&(e("#fancy_title div").html(t.itemArray[t.itemNum].title),e("#fancy_title").show()),t.itemArray[t.itemNum].o.hideOnContentClick?e("#fancy_content").click(e.fn.fancybox.close):e("#fancy_content").unbind("click"),0!=t.itemNum&&(e("#fancy_nav").append('<a id="fancy_left" href="javascript:;"></a>'),e("#fancy_left").click(function(){return e.fn.fancybox.changeItem(t.itemNum-1),!1})),t.itemNum!=t.itemArray.length-1&&(e("#fancy_nav").append('<a id="fancy_right" href="javascript:;"></a>'),e("#fancy_right").click(function(){return e.fn.fancybox.changeItem(t.itemNum+1),!1})),e(document).keydown(function(n){27==n.keyCode?e.fn.fancybox.close():37==n.keyCode&&0!=t.itemNum?e.fn.fancybox.changeItem(t.itemNum-1):39==n.keyCode&&t.itemNum!=t.itemArray.length-1&&e.fn.fancybox.changeItem(t.itemNum+1)})},e.fn.fancybox.preloadNeighborImages=function(){t.itemArray.length-1>t.itemNum&&(preloadNextImage=new Image,preloadNextImage.src=t.itemArray[t.itemNum+1].url),t.itemNum>0&&(preloadPrevImage=new Image,preloadPrevImage.src=t.itemArray[t.itemNum-1].url)},e.fn.fancybox.close=function(){if(t.animating)return!1;if(e(i).unbind("load"),e(document).unbind("keydown"),e("#fancy_loading,#fancy_title,#fancy_close,#fancy_bg").hide(),e("#fancy_nav").empty(),t.active=!1,t.itemArray[t.itemNum].o.zoomSpeedOut>0){var n={top:t.itemArray[t.itemNum].orig.pos.top-18,left:t.itemArray[t.itemNum].orig.pos.left-18,height:t.itemArray[t.itemNum].orig.height,width:t.itemArray[t.itemNum].orig.width,opacity:"hide"};t.animating=!0,e("#fancy_outer").animate(n,t.itemArray[t.itemNum].o.zoomSpeedOut,function(){e("#fancy_content").hide().empty(),e("#fancy_overlay,#fancy_bigIframe").remove(),t.animating=!1})}else e("#fancy_outer").hide(),e("#fancy_content").hide().empty(),e("#fancy_overlay,#fancy_bigIframe").fadeOut("fast").remove()},e.fn.fancybox.showLoading=function(){clearInterval(n);var t=e.fn.fancybox.getViewport();e("#fancy_loading").css({left:(t[0]-40)/2+t[2],top:(t[1]-40)/2+t[3]}).show(),e("#fancy_loading").bind("click",e.fn.fancybox.close),n=setInterval(e.fn.fancybox.animateLoading,66)},e.fn.fancybox.animateLoading=function(){return e("#fancy_loading").is(":visible")?(e("#fancy_loading > div").css("top",-40*o+"px"),o=(o+1)%12,void 0):(clearInterval(n),void 0)},e.fn.fancybox.init=function(){e("#fancy_wrap").length||(e('<div id="fancy_wrap"><div id="fancy_loading"><div></div></div><div id="fancy_outer"><div id="fancy_inner"><div id="fancy_nav"></div><div id="fancy_close"></div><div id="fancy_content"></div><div id="fancy_title"></div></div></div></div>').appendTo("body"),e('<div id="fancy_bg"><div class="fancy_bg fancy_bg_n"></div><div class="fancy_bg fancy_bg_ne"></div><div class="fancy_bg fancy_bg_e"></div><div class="fancy_bg fancy_bg_se"></div><div class="fancy_bg fancy_bg_s"></div><div class="fancy_bg fancy_bg_sw"></div><div class="fancy_bg fancy_bg_w"></div><div class="fancy_bg fancy_bg_nw"></div></div>').prependTo("#fancy_inner"),e('<table cellspacing="0" cellpadding="0" border="0"><tr><td id="fancy_title_left"></td><td id="fancy_title_main"><div></div></td><td id="fancy_title_right"></td></tr></table>').appendTo("#fancy_title")),e.browser.msie&&e("#fancy_inner").prepend('<iframe id="fancy_freeIframe" scrolling="no" frameborder="0"></iframe>'),jQuery.fn.pngFix&&e(document).pngFix(),e("#fancy_close").click(e.fn.fancybox.close)},e.fn.fancybox.getPosition=function(n){var t=n.offset();return t.top+=e.fn.fancybox.num(n,"paddingTop"),t.top+=e.fn.fancybox.num(n,"borderTopWidth"),t.left+=e.fn.fancybox.num(n,"paddingLeft"),t.left+=e.fn.fancybox.num(n,"borderLeftWidth"),t},e.fn.fancybox.num=function(n,t){return parseInt(e.curCSS(n.jquery?n[0]:n,t,!0))||0},e.fn.fancybox.getPageScroll=function(){var e,n;return self.pageYOffset?(n=self.pageYOffset,e=self.pageXOffset):document.documentElement&&document.documentElement.scrollTop?(n=document.documentElement.scrollTop,e=document.documentElement.scrollLeft):document.body&&(n=document.body.scrollTop,e=document.body.scrollLeft),[e,n]},e.fn.fancybox.getViewport=function(){var n=e.fn.fancybox.getPageScroll();return[e(window).width(),e(window).height(),n[0],n[1]]},e.fn.fancybox.getMaxSize=function(e,n,t,i){var a=Math.min(Math.min(e,t)/t,Math.min(n,i)/i);return[Math.round(a*t),Math.round(a*i)]},e.fn.fancybox.defaults={hideOnContentClick:!1,zoomSpeedIn:500,zoomSpeedOut:500,frameWidth:600,frameHeight:400,overlayShow:!1,overlayOpacity:.4,itemLoadCallback:null}}(jQuery);