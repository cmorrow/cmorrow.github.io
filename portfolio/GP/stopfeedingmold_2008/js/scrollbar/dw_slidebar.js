/*************************************************************************
  This code is from Dynamic Web Coding at www.dyn-web.com
  Copyright 2004 by Sharon Paine 
  See Terms of Use at www.dyn-web.com/bus/terms.html
  regarding conditions under which you may use this code.
  This notice must be retained in the code as is!
*************************************************************************/
var dw_slidebar={obj:null,slideDur:500,init:function(t,e,d,a,s){a=a||0,s=s||0,t.style.left=a+"px",t.style.top=s+"px",t.axis=d,e.bar=t,"h"==d?(t.trkWd=e.offsetWidth,t.maxX=t.trkWd-t.offsetWidth-a,t.minX=a,t.maxY=s,t.minY=s):(t.trkHt=e.offsetHeight,t.maxY=t.trkHt-t.offsetHeight-s,t.maxX=a,t.minX=a,t.minY=s),t.on_drag_start=t.on_drag=t.on_drag_end=t.on_slide_start=t.on_slide=t.on_slide_end=function(){},t.onmousedown=this.startDrag,e.onmousedown=this.startSlide},startSlide:function(t){dw_slidebar.aniTimer&&clearInterval(dw_slidebar.aniTimer),t=t?t:window.event;var e=dw_slidebar.obj=this.bar;t.offX="undefined"!=typeof t.layerX?t.layerX:t.offsetX,t.offY="undefined"!=typeof t.layerY?t.layerY:t.offsetY,e.startX=parseInt(e.style.left),e.startY=parseInt(e.style.top),"v"==e.axis?(e.destX=e.startX,e.destY=t.offY<e.startY?t.offY:t.offY-e.offsetHeight,e.destY=Math.min(Math.max(e.destY,e.minY),e.maxY)):(e.destX=t.offX<e.startX?t.offX:t.offX-e.offsetWidth,e.destX=Math.min(Math.max(e.destX,e.minX),e.maxX),e.destY=e.startY),e.distX=e.destX-e.startX,e.distY=e.destY-e.startY,dw_slidebar.per=Math.PI/(2*dw_slidebar.slideDur),dw_slidebar.slideStart=(new Date).getTime(),e.on_slide_start(e.startX,e.startY),dw_slidebar.aniTimer=setInterval("dw_slidebar.doSlide()",10)},doSlide:function(){if(!dw_slidebar.obj)return clearInterval(dw_slidebar.aniTimer),void 0;var t=dw_slidebar.obj,e=(new Date).getTime()-this.slideStart;if(e<this.slideDur){var d=t.startX+t.distX*Math.sin(this.per*e),a=t.startY+t.distY*Math.sin(this.per*e);t.style.left=d+"px",t.style.top=a+"px",t.on_slide(d,a)}else clearInterval(this.aniTimer),t.style.left=t.destX+"px",t.style.top=t.destY+"px",t.on_slide_end(t.destX,t.destY),this.obj=null},startDrag:function(t){t=dw_event.DOMit(t),dw_slidebar.aniTimer&&clearInterval(dw_slidebar.aniTimer);var e=dw_slidebar.obj=this;e.downX=t.clientX,e.downY=t.clientY,e.startX=parseInt(e.style.left),e.startY=parseInt(e.style.top),e.on_drag_start(e.startX,e.startY),dw_event.add(document,"mousemove",dw_slidebar.doDrag,!0),dw_event.add(document,"mouseup",dw_slidebar.endDrag,!0),t.stopPropagation()},doDrag:function(t){if(t=t?t:window.event,dw_slidebar.obj){var e=dw_slidebar.obj,d=e.startX+t.clientX-e.downX,a=e.startY+t.clientY-e.downY;return d=Math.min(Math.max(e.minX,d),e.maxX),a=Math.min(Math.max(e.minY,a),e.maxY),e.style.left=d+"px",e.style.top=a+"px",e.on_drag(d,a),!1}},endDrag:function(){dw_event.remove(document,"mousemove",dw_slidebar.doDrag,!0),dw_event.remove(document,"mouseup",dw_slidebar.endDrag,!0),dw_slidebar.obj&&(dw_slidebar.obj.on_drag_end(parseInt(dw_slidebar.obj.style.left),parseInt(dw_slidebar.obj.style.top)),dw_slidebar.obj=null)}};